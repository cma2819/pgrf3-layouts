import{r as t,b as e,d as s,e as a,p as n,a as r,o,F as i,j as c,f as l,c as d,u,t as m,i as p,T as f,w as g,D as h,l as y,m as v}from"./vendor.cd1d5b6d.js";const w={props:{scale:{type:Number,default:1},top:{type:Number,default:0},from:{type:String,default:"left"},animated:Boolean},setup(n){const r=n,o=(t,e)=>Math.random()*(e-t)+t,i=t({"from-right":"right"===r.from,"from-left":"left"===r.from,animated:r.animated}),c=t({top:`${r.top}px`,transform:`scale(${r.scale}) rotate(${r.animated?0:o(0,360)}deg)`,left:`${r.animated?-150:o(-150,2070)}px`,opacity:r.animated?1:o(.1,.3)});return(t,r)=>(e(),s("div",{class:["triangle-container",i.value],style:c.value},[a("div",{class:["triangle",{animated:n.animated}]},null,2)],6))},__scopeId:"data-v-f06d386e"};n("data-v-4546e6ed");const T={id:"wrapper"},S=a("div",{id:"filter"},null,-1),A={id:"shapes"};r();const R={props:{animated:Boolean},setup(n){const r=n,l=t([]),d=(t,e)=>Math.random()*(e-t)+t,u=()=>{l.value.push({scale:d(.2,.8),top:d(-100,1180),from:d(0,1)>.5?"left":"right",key:(new Date).getTime()}),r.animated&&setTimeout((()=>l.value.shift()),1e4)};return o((()=>{r.animated?setInterval(u,200):[...Array(100).keys()].forEach((t=>u()))})),(t,r)=>(e(),s("div",T,[S,a("div",A,[(e(!0),s(i,null,c(l.value,((t,a)=>(e(),s(w,{key:t.key,scale:t.scale,top:t.top,from:t.from,animated:n.animated},null,8,["scale","top","from","animated"])))),128))])]))},__scopeId:"data-v-4546e6ed"};const b=g();n("data-v-212308bc");const I={key:0,id:"tweet"},$={class:"box"},j={id:"twitter-user"},x={id:"twitter-id"};r();const M={props:{width:{type:String,default:"420px"},small:{type:Boolean},from:{type:String,default:"left"}},setup(t){const n=t,r=l(),o=d((()=>r.getters.tweet)),i=d((()=>({"from-left":"left"===n.from,"from-right":"right"===n.from,"from-top":"top"===n.from})));return(n,r)=>(e(),s(f,{name:`slide-from-${t.from}`},{default:b((()=>[u(o)?(e(),s("div",{key:0,id:"tweet-wrapper",class:u(i)},[u(o)?(e(),s("div",I,[a("div",$,[a("div",j,[a("img",{id:"twitter-icon",src:u(o).icon,alt:"icon"},null,8,["src"]),a("span",x,"@"+m(u(o).id),1)]),a("div",{id:"tweet-text",class:{small:t.small}},m(u(o).content),3)])])):p("",!0)],2)):p("",!0)])),_:1},8,["name"]))},__scopeId:"data-v-212308bc"},_={setup(t){const e=l();return o((()=>{const t=nodecg,s=nodecg;t.Replicant("runDataActiveRunSurrounding","nodecg-speedcontrol").on("change",(a=>{t.readReplicant("runDataArray","nodecg-speedcontrol",(t=>{const n=a.current,r=Math.max(t.findIndex((t=>t.id===n)),0);s.readReplicant("commentatorArray","speedcontrol-additions",(a=>{s.readReplicant("speedcontrolUserAdditionArray","speedcontrol-additions",(s=>{const n=t.slice(r,r+4).map((t=>{return{title:t.game||"",category:t.category||"",platform:t.system||"",startsAt:(e=new Date(t.scheduled),`${e.getFullYear()}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}`),est:t.estimate||"",runners:t.teams.flatMap((t=>t.players.map((e=>{var a,n,r;const o=s.find((t=>t.id===e.id));return{id:t.id,name:e.name,accounts:{twitch:e.social.twitch,twitter:null==(a=null==o?void 0:o.social)?void 0:a.twitter,nico:null==(n=null==o?void 0:o.social)?void 0:n.nico,youtube:null==(r=null==o?void 0:o.social)?void 0:r.youtube}}})))),commentators:a.filter((e=>e.assignedRunIdArray.includes(t.externalID))).map((t=>({name:t.name,accounts:t.social})))};var e}));e.dispatch("setRuns",n)}))}))}))}));const a={stopped:"suspend",running:"running",paused:"suspend",finished:"complete"};t.Replicant("timer","nodecg-speedcontrol").on("change",(t=>{e.dispatch("setTimer",{time:t.time||"00:00",status:a[t.state||"paused"],split:(Object.entries(t.teamFinishTimes)||[]).map((([t,e])=>({id:t,time:e.time})))})}));nodecg.Replicant("spotifyPlayingTrack","nodecg-spotify-widget").on("change",(t=>{e.dispatch("setMusic",{title:(null==t?void 0:t.name)||"",artist:(null==t?void 0:t.artists.join(","))||""})}));nodecg.Replicant("activeTweet","nodecg-twitter-widget").on("change",(t=>{e.dispatch("setTweet",t&&{id:t.screenName,icon:t.profileImageUrl,content:t.text})}));nodecg.Replicant("runner-scores").on("change",(t=>{e.dispatch("setScores",t.filter((t=>null!==t.score)))}))})),()=>{}}};class k{constructor(t){this.title=t.title,this.category=t.category,this.platform=t.platform,this.startsAt=h.fromFormat(t.startsAt,"yyyy/MM/dd HH:mm:ss"),this.est=t.est,this.runners=t.runners,this.commentators=t.commentators}joinedRunnerNames(t=" / "){return this.runners.map((t=>t.name)).join(t)}joinedCommentatorNames(t=" / "){return this.commentators.map((t=>t.name)).join(t)}startsAtOnSchedule(){return this.startsAt.toFormat("HH:mm")}isSetupBlock(){return!this.runners||0===this.runners.length}}class F{constructor(t){this.id=t.id,this.name=t.name,this.accounts=this._excludeEmptyField(t.accounts),this.accountTypes=Object.keys(this.accounts)}currentAccount(){return{[this.accountTypes[0]]:this.accounts[this.accountTypes[0]]}}rotateAccountTypes(){this.accountTypes=this.accountTypes.slice(1).concat(this.accountTypes[0])}_excludeEmptyField(t){return Object.entries(t).filter((([t,e])=>e)).reduce(((t,[e,s])=>Object.assign(t,{[e]:s})),{})}}var O=v({modules:{runs:{state:()=>({runs:[],currentRunners:[],currentCommentators:[]}),getters:{runsOnSchedule:({runs:t})=>t.slice(0,3).map((t=>new k(t))),currentEst({runs:t}){var e;return null==(e=t[0])?void 0:e.est},headerInfo({runs:t}){var e,s,a;return{title:null==(e=t[0])?void 0:e.title,category:null==(s=t[0])?void 0:s.category,platform:null==(a=t[0])?void 0:a.platform}},footerInfo:({runs:t})=>t.length>1&&t[1].category?{title:t[1].title,category:t[1].category}:void 0},mutations:{setRuns(t,e){t.runs=e,t.currentRunners=e[0].runners.map((t=>new F(t))),t.currentCommentators=e[0].commentators.map((t=>new F(t)))},rotateAccounts({currentRunners:t,currentCommentators:e}){t.forEach((t=>{t.rotateAccountTypes()})),e.forEach((t=>{t.rotateAccountTypes()}))}},actions:{setRuns({commit:t},e){t("setRuns",e)},rotateAccounts({commit:t}){t("rotateAccounts")}}},timer:{state:()=>({time:"",status:"",splits:[]}),getters:{formattedTime:({time:t})=>{const e=t.split(":"),s=y.fromObject({hours:parseInt(e[0]||"0"),minutes:parseInt(e[1]||"0"),seconds:parseInt(e[2]||"0")});return s.hours>0?s.toFormat("hh:mm:ss"):s.toFormat("mm:ss")},splitOfId:({splits:t})=>e=>{const s=t.find((t=>e===t.id));return s?s.time:""}},mutations:{setTimer(t,e){t.time=e.time,t.status=e.status,t.splits=e.split}},actions:{setTimer({commit:t},e){t("setTimer",e)}}},scores:{state:()=>({scores:[]}),getters:{scoreOf:({scores:t})=>e=>{const s=t.find((t=>t.id===e));return s?s.score:0}},mutations:{setScores(t,e){t.scores=e}},actions:{setScores({commit:t},e){t("setScores",e)}}},tweet:{state:()=>({tweet:null}),getters:{tweet:({tweet:t})=>t},mutations:{setTweet(t,e){t.tweet=e}},actions:{setTweet({commit:t},e){t("setTweet",e)}}},spotify:{state:()=>({title:"",artist:""}),getters:{shortSpotifyInfo({title:t,artist:e}){const s=`${t} / ${e}`;return s.length>80?`${s.substring(0,80)}...`:s}},mutations:{setMusic(t,e){t.title=e.title,t.artist=e.artist}},actions:{setMusic({commit:t},e){t("setMusic",e)}}}}});export{_,R as a,M as b,O as s};
